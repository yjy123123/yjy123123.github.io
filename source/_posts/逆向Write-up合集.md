---
title: é€†å‘Write upåˆé›†
date: 2021-03-06 15:06:06
tags: é€†å‘
description: CTFé€†å‘é¢˜ç»ƒæ‰‹åˆé›†ï¼Œä¹‹åŽå¯èƒ½ä¼šæ›´å¤šçš„æ€»ç»“çŸ¥è¯†ç‚¹ï¼ŒæŒç»­æ›´æ–°ã€‚
---
## XCTFæ”»é˜²ä¸–ç•Œ

### open_source

è¿™é“é¢˜ç›´æŽ¥ç»™äº†æºç ï¼Œè¯»å°±è¡Œäº†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ–‡ä»¶åæ˜¯32ä½hashï¼Œä½†æ˜¯è®¡ç®—çš„è¯å¤ªå¤§ï¼Œä¹Ÿæ— æ³•è§£å¯†ï¼Œæ‰€ä»¥çªç ´å£è¿˜æ˜¯hashæœ¬èº«çš„è®¡ç®—ï¼Œä»Žä¹‹å‰çš„åˆ¤æ–­å¯ä»¥æŽ¨å‡ºï¼Œå…¶å®ž(second % 17)å°±æ˜¯ç­‰äºŽ8ã€‚

ç®—å‡ºæ¥è¿˜è¦è½¬ä¸º16è¿›åˆ¶ã€‚


### logmein

ä¹Ÿæ˜¯è€ƒçš„é˜…è¯»cçš„èƒ½åŠ›ï¼Œæ‹–åˆ°idaé‡Œé¢F5åç¼–è¯‘ï¼Œç®€å•è¯»ä¸€ä¸‹ï¼Œçªç ´å£åº”è¯¥åœ¨åˆ¤æ–­è¯­å¥é‡Œé¢ã€‚

![](reverse-1.png)

å¤„ç†ä¹‹åŽæç¤ºæ•°å¤ªå¤§äº†ï¼Œä¹çœ‹ä¸€çœ¼*(_BYTE *)ä¸å¤ªç†è§£ä»€ä¹ˆæ„æ€ï¼Œä½†æ˜¯æ„Ÿè§‰longæ•´æ•°å’Œå­—ç¬¦ä¸²é•¿åº¦å·®ä¸å¤šï¼Œå¯ä»¥åˆç†æŽ¨æµ‹ï¼Œå¯èƒ½éœ€è¦å¯¹longåž‹çš„æ•°æ®ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„å¤„ç†ã€‚

ç»“æžœæ˜¯æˆ‘çœ‹é”™äº†ï¼Œæ‹¬å·å…¶å®žå¯¹åº”é”™äº†ï¼Œ(*((_BYTE *)&v7 + i % v6)ï¼Œ(_BYTE *)&v7æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå®žçŽ°çš„åŠŸèƒ½ä¹Ÿæ˜¯ä»Žlongä¸­ä¾æ¬¡å–ä¸€ä¸ªå­—èŠ‚çš„æ•°ã€‚

é¦–å…ˆè¦çŸ¥é“longåœ¨æœºå™¨ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œæ‰çŸ¥é“æ€Žä¹ˆå–å‡ºï¼Œåœ¨æ±‡ç¼–ä¸­ï¼Œä¸€èˆ¬æ˜¯å°ç«¯å­˜å‚¨ï¼Œæ‰€ä»¥æŒ‰åœ°å€å–æ•°æ˜¯ä»Žä½Žä½å¼€å§‹å¾€é«˜ä½å–ï¼Œä¸€ä¸ªå­—èŠ‚å¯ä»¥å­˜å‚¨ä¸¤ä¸ª16è¿›åˆ¶æ•°ï¼Œæ‰€ä»¥ä¸€æ¬¡å–ä¸¤ä¸ªæ•°ï¼Œè¿™ä¹Ÿè§£é‡Ši % 7 çš„åŽŸå› ã€‚

æœ€å¼€å§‹æƒ³ç”¨æ¨¡è¿ç®—å–æ•°ï¼Œè¿˜åœç•™åœ¨10è¿›åˆ¶ä¸­ï¼Œä½†æ˜¯pythonå®žçŽ°16è¿›åˆ¶æ¨¡è¿ç®—æœ‰ä¸€ä¸ªå‘å°±æ˜¯ï¼Œä¼šæŠŠ%è¯†åˆ«æˆæ ¼å¼åŒ–çš„ç¬¦å·ï¼Œæ‰€ä»¥è¿™äº†é‡‡ç”¨```x>>(8^i)&0xFF```æ¥å–æ•°æ®ã€‚

æœ€åŽ16è¿›åˆ¶ç»“æžœè¦è½¬ä¸ºasciiç ã€‚

è¿™é“é¢˜èŠ±äº†ä¸€ç‚¹æ—¶é—´ï¼Œæˆ‘ç”¨pythonå¤„ç†è¿›åˆ¶çš„è½¬æ¢éžå¸¸çš„ä¸ç†Ÿæ‚‰ï¼ŒçœŸçš„å¤´å¤§ã€‚

[è¿™ç¯‡æ–‡ç« ](https://reverseengineering.stackexchange.com/questions/13703/what-is-byte-usercall-eax-and-edi)ä¸­å¯¹*(_BYTE *)çš„è§£é‡Šï¼š

```
This actually has two distinctive parts, evaluated one after the other.

First, (_BYTE *) casts a value or a register to be a byte pointer. This is similar to assigning the value to a C variable which is defined as byte *.

Second, * dereferences the address and retrieves the value in that address, value is assumed to be of the type of the pointer, in our case _BYTE.
```

æ‹†è§£å‡ºæ¥å°±æ˜¯å…ˆå°†å€¼è½¬æ¢ä¸ºå­—èŠ‚æŒ‡é’ˆï¼Œä¹‹åŽå†æ‰¾åœ°å€å¯¹åº”å€¼ã€‚

---
æˆ‘è§‰å¾—è‡ªå·±çš„è§£æ³•å¤ªéº»çƒ¦äº†ï¼Œæœ€åŽçœ‹äº†ä¸€ä¸‹å…¶ä»–äººçš„ï¼Œæœ‰çš„v7åæ±‡ç¼–å‡ºæ¥å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è€Œä¸æ˜¯longåž‹ï¼Œä½†æ˜¯è¿™ä¸ªä¼°è®¡ä¸€å¼€å§‹ä¼šæƒ³ä¸åˆ°å°ç«¯å­˜å‚¨ï¼ŒæŠŠv7æ¢æˆå­—ç¬¦ä¸²å¤„ç†ç¡®å®žæ–¹ä¾¿å¾ˆå¤šã€‚

### insanity

å…ˆç”¨idaçœ‹äº†ä¸€ä¸‹ï¼Œåç¼–è¯‘å‡ºæ¥çš„ç»“æžœå¾ˆç®€å•ï¼Œçœ‹ä¸€çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰æ•ˆçš„å­—ç¬¦ä¿¡æ¯ã€‚ç›´æŽ¥çœ‹åˆ°ä¸€ä¸ªåƒflagçš„ä¸œè¥¿ï¼Œæˆ‘å¼€å§‹åªæäº¤äº†å­—ç¬¦ï¼Œæ²¡åŠ å‰é¢æ•°å­—ï¼Œè¿˜å¥½å†å°è¯•æäº¤äº†ä¸€æ¬¡ï¼Œä¸ç„¶åˆæŽ‰å‘é‡Œé¢äº†ã€‚

### getit

idaåç¼–è¯‘mainå‡½æ•°ï¼Œæ„Ÿè§‰æ ¸å¿ƒå†…å®¹æ˜¯å¯¹"/tmp/flag.txt"æ–‡ä»¶çš„å†™å…¥ï¼Œfputcåšçš„å°±æ˜¯å†™å…¥æ“ä½œï¼Œå¦å¤–å…³æ³¨så’Œtä¸¤ä¸ªå‚æ•°ï¼Œä»Žé•¿åº¦æ¥çœ‹ï¼Œæ„Ÿè§‰åˆæ˜¯å’Œlogmeinä¸€æ ·çš„å¥—è·¯ï¼Œä½†æ˜¯ç®€å•å¾ˆå¤šï¼Œä¹Ÿæ²¡ä»€ä¹ˆå¤§å°ç«¯ã€‚

ä½†æ˜¯æ€»æ˜¯æäº¤ä¸å¯¹ï¼Œæˆ‘è¿˜ä»¥ä¸ºç¬¬äºŒæ­¥æ–‡ä»¶å†™å…¥æ‰“ä¹±é¡ºåºäº†å†™å…¥ï¼Œå¯èƒ½è¦åŠ¨æ€è°ƒè¯•å› ä¸ºå¤ªéº»çƒ¦äº†å‡†å¤‡çœ‹ä¸€ä¸‹åˆ°åº•æ€Žä¹ˆå›žäº‹ï¼Œç»“æžœæ˜¯idaé‡Œé¢å­—ç¬¦ä¸²åªæ˜¾ç¤ºäº†```harifCTF{}```ï¼ŒæŽ‰äº†ä¸€ä¸ªSï¼Œghidraé‡Œé¢å¯ä»¥æ­£å¸¸æ˜¾ç¤ºå‡ºï¼Œæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘å·®ç‚¹éª‚å‡ºä¸–ç•Œä¸Šæœ€è„çš„è„è¯ã€‚ä¸è¿‡è¿™é“é¢˜ç¡®å®žå¯ä»¥åŠ¨æ€åˆ†æžè·‘å‡ºæ¥ï¼Œæ›´å¿«ä¸€ç‚¹ã€‚

### python-trade

è¿™ä¸€é“é¢˜æ˜¯pythonåç¼–è¯‘ï¼Œ```pip install uncompyle```ï¼Œç”¨uncompyleåç¼–è¯‘å‡ºæ¥ç›´æŽ¥æ˜¯pythonä»£ç äº†ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹å°±æ˜¯ï¼Œbase64è§£ç å‡ºæ¥çš„ç»“æžœæ˜¯bytesã€‚

### re1

åç¼–è¯‘ä¹‹åŽçœ‹åˆ°strcmpï¼Œv9å’Œv5ï¼Œv5æ˜¯ç”¨æˆ·è¾“å…¥ï¼Œçªç ´å£å°±æ˜¯v9äº†ï¼Œé¡ºç€æ‰¾è¿‡åŽ»æ˜¯ä¸€ä¸²16è¿›åˆ¶æ•°ï¼Œåˆ†æˆäº†ä¸¤æ®µï¼Œç›´æŽ¥16è¿›åˆ¶è½¬asciiç çœ‹ä¸€ä¸‹ï¼Œæ˜¯ä¸€ä¸²åƒflagçš„ä¸œè¥¿ï¼Œä½†æ˜¯é¡ºåºæ˜¯åçš„ï¼Œä»Žç¨‹åºé€»è¾‘æ¥çœ‹å°±æ˜¯flagï¼Œä¸çŸ¥é“è€ƒç‚¹æ˜¯å•¥ã€‚

è€Œä¸”è¿™é“é¢˜åœ¨macosä¸‹ä¼šä¹±ç ã€‚

### game

è¿™é“é¢˜æ„Ÿè§‰ç¨‹åºæ¯”è¾ƒå¤§ï¼Œç®€å•ç”¨idaçœ‹äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆæœ‰æ•ˆä¿¡æ¯ï¼Œæ‰€ä»¥è¿˜æ˜¯è¿è¡ŒçŽ©ä¸€çŽ©æ¸¸æˆï¼Œæ„Ÿè§‰è¿™é“é¢˜å¯èƒ½ç”¨åŠ¨æ€åˆ†æžå·¥å…·æ¯”è¾ƒå¥½ï¼ŒçŽ°åœ¨æ˜¯è€ƒè™‘ä¿®æ”¹å†…å­˜æŠŠç¯å…¨éƒ¨ç‚¹äº®ã€‚

### å°æ€»ç»“

åšäº†å¥½å‡ é“é¢˜ï¼Œç®€å•é¢˜åŸºæœ¬ä¸Šè¿˜æ˜¯è¯»Cï¼Œè¦ç†Ÿæ‚‰16è¿›åˆ¶çš„å„ç§æ“ä½œï¼Œè€Œä¸”æœ¬è´¨å°±æ˜¯é€šè¿‡åŠ å¯†ç®—æ³•å†™å¯¹åº”çš„è§£å¯†ç®—æ³•ã€‚



### simple-unpack

ç»™äº†æç¤ºæ˜¯è„±å£³ç›¸å…³çš„ï¼Œä¹‹å‰ç”µè„‘é‡Œé¢ä¸‹äº†upxï¼ŒæŸ¥äº†ä¸€ä¸‹æŒ‡ä»¤ï¼Œupx -d ç›´æŽ¥è„±å£³ï¼Œæ„Ÿè§‰æˆ‘ -hä¸å¤ªä¼šçœ‹ï¼Œåº”è¯¥è¦å­¦ä¸€å­¦ã€‚



### Hello, CTF

è¿™é“é¢˜ï¼ŒF5åç¼–è¯‘ä¹‹åŽç›´æŽ¥é˜…è¯»ä»£ç ï¼Œå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è¾“å…¥å’Œå­—ç¬¦ä¸²â€œ437261636b4d654a757374466f7246756eâ€æ¯”è¾ƒï¼Œä½†æ˜¯è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥ä¸º17ï¼Œè¢«æ¯”è¾ƒçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º35ï¼Œæˆ‘å½“æ—¶å°±åƒï¼Œå•Šï¼Œè¿™æ˜¯æº¢å‡ºå—ï¼Œæ²¡ä»€ä¹ˆæƒ³æ³•ï¼Œç„¶åŽåˆ°å¤„çœ‹äº†çœ‹ï¼Œæ— æ„é—´å›žåˆ°é¢˜ç›®æè¿°

> èœé¸¡å‘çŽ°Flagä¼¼ä¹Žå¹¶ä¸ä¸€å®šæ˜¯æ˜Žæ–‡æ¯”è¾ƒçš„



ç„¶åŽæˆ‘æ‚Ÿäº†ï¼Œ16è¿›åˆ¶è½¬asciiï¼Œflagå°±å‡ºæ¥äº†ï¼Œæ€Žä¹ˆè¯´å‘¢ï¼Œä¸€å‘¨å¤šæ²¡åšé¢˜äº†ï¼Œæ„Ÿè§‰è„‘å­å°±åƒç”Ÿé”ˆäº†ä¸€æ ·ï¼Œä¸å¤ªæ•é”äº†ï¼Œåœ¨æ€è€ƒå¦‚æžœæ²¡æœ‰é¢˜ç›®æè¿°ï¼Œæˆ‘è§£è¿™é“é¢˜è¦å¤šä¹…ã€‚

ä¹‹å‰è¿žåšå…­ä¸ƒé“é¢˜çš„æ—¶å€™ï¼Œå¯¹æœ‰äº›å¥—è·¯è¿˜æ˜¯æœ‰ç‚¹æ„Ÿè§‰çš„ï¼Œå¾ˆå¿«å°±èƒ½getåˆ°ï¼Œåˆ°äº†è¿™å‘¨ï¼Œæˆ‘å°±æ¨è‡ªå·±æ˜¯å—æœ¨å¤´ã€‚



### no-strings-attached

è¿™é“é¢˜åšçš„å¤ªè‡ªé—­äº†ï¼Œçœ‹äº†é¢˜ç›®æè¿°ï¼Œè¯´è¿è¡Œå°±å¯ä»¥æ‹¿flagï¼Œæ‰€ä»¥å…¨å¿ƒå…¨æ„æƒ³ç€æ€Žä¹ˆè¿è¡Œèµ·æ¥ï¼Œlinuxä¸‹çš„32ä½elfæ–‡ä»¶ï¼Œå¥½ä¸å®¹æ˜“å®‰è£…32ä½çš„libåº“ï¼Œè¿è¡Œè¿˜æŠ¥é”™ï¼Œæ•´ä¸ªäººéƒ½å‚»äº†ã€‚

```
sudo apt-get install lib32ncurses5
```

æœ€åŽè¿˜æ˜¯å›žå½’idaï¼Œç»“æžœå°±æ˜¯ä¸€ä¸ªæ™®é€šå¥—è·¯çš„åŠ è§£å¯†ï¼Œä¸¤ä¸ªæ•°ç»„æ“ä½œï¼Œæµªè´¹å¤§é‡æ—¶é—´æƒ³æŠŠå®ƒè·‘èµ·æ¥çš„æˆ‘æ·±æ·±å¹äº†ä¸€å£æ°”ã€‚



### maze

ä¸€å¼€å§‹ç›´æŽ¥IDAé™æ€åˆ†æžï¼ŒF5åç¼–è¯‘ä¹‹åŽï¼Œé‡ç‚¹çœ‹äº†ä¸€ä¸‹mainå‡½æ•°ï¼Œæ„Ÿè§‰æœ‰ç‚¹ä¸å¤ªå¯¹ï¼Œå› ä¸ºç›´æŽ¥é ç”¨æˆ·è¾“å…¥è¿›è¡Œè§„åˆ™åˆ¤å®šï¼Œå”¯ä¸€æœ‰å‚è€ƒä»·å€¼çš„å­—ç¬¦ä¸²asc_601060çœ‹ä¸å‡ºä»€ä¹ˆåå ‚ï¼Œæ„Ÿè§‰é™æ€åˆ†æžä¸å¤ªå¯é ã€‚éš¾é“æ˜¯æŒ‰è§„åˆ™ç©·ä¸¾æš´åŠ›ç ´è§£å—ï¼ŸåŽé¢ä»”ç»†è§‚å¯Ÿifè¯­å¥é‡Œé¢çš„åˆ¤æ–­æ¡ä»¶ï¼Œçœ‹äº†ä¸€ä¸‹å‡ºçŽ°çš„åè¿›åˆ¶æ•°å¯¹åº”çš„asciiç ï¼ˆå…¶å®žæ˜¯å› ä¸ºè¯»äº†ä¸€åŠè¯»åäº†ï¼Œä¸ºäº†é¿å…å…¥é—¨åˆ°æ”¾å¼ƒå¦å¯»å‡ºè·¯ã€‚

```
79 - O
111 - o
46 - .
48 - 0
35 - #
```


å‚è€ƒäº†ä¸€ä¸‹IDAåŠ¨æ€è°ƒè¯•çš„[åšå®¢](https://blog.csdn.net/abc_670/article/details/80066817)

æŠŠå‡ ä¸ªåˆ¤æ–­è·³è½¬çš„åœ°æ–¹ï¼Œç‰¹åˆ«æ˜¯è·³è½¬åˆ°label_22è¦é€€å‡ºçš„åœ°æ–¹ä¸‹äº†æ–­ç‚¹ï¼Œè¯•ä¸€è¯•`nctf{000000000000000000}`ï¼Œå‘çŽ°å¯ä»¥å•æ­¥ã€‚å¼„äº†åŠå¤©æ— å‘çŽ°ï¼Œå€’æ˜¯æŸä¸€ç¯‡åšå®¢é‡Œé¢æåˆ°ï¼Œæƒ³è¦ç»ƒæ‰‹å¯ä»¥è¯•ä¸€è¯•xctfçš„track2ï¼Œè¿™å°±æ„å‘³ç€ï¼Œè¿™é“é¢˜åº”è¯¥ä¸æ˜¯åŠ¨æ€è°ƒè¯•ã€‚

åˆå›žåˆ°mainå‡½æ•°ï¼Œä½†æ˜¯åˆ¤æ–­è¯­å¥å¤ªå¤šï¼Œæ‹¬å·ä»€ä¹ˆçš„ä¸å¥½çœ‹ï¼Œè£…äº†ä¸€ä¸ªé«˜äº®æ‹¬å·çš„[hexlightæ’ä»¶](https://www.52pojie.cn/thread-727586-1-1.html)ï¼Œä½†æ˜¯æ„Ÿè§‰ä½¿ç”¨æ„Ÿä¸€èˆ¬ã€‚

ä¹‹åŽå°±æ˜¯åˆ†æž-æŽ¨ç¿»-åˆ†æž-æŽ¨ç¿»ï¼Œæžåˆ°è‡ªé—­çš„å¾ªçŽ¯ï¼Œæœ€åŽå›žåˆ°é¢˜ç›®æ è¿°ï¼Œèœé¸¡èµ°å‡ºè¿·å®«s m deï¼Œç»“åˆasc_601060ï¼Œä¸€å…±64ä½ï¼Œé‚£ä¹ˆå¼„æˆ8*8çŸ©é˜µçœ‹çœ‹ä»€ä¹ˆæƒ…å†µï¼Œå°±çœŸâ€¢è¿·å®«å‘—ï¼Œä¸è¿‡â€˜mazeâ€™è¿™ä¸ªè¯æœ¬èº«ä¹Ÿæœ‰è¿·å®«çš„æ„æ€ï¼Œå“Žï¼Œè¿™å°±æ˜¯è‹±è¯­ä¸å¥½çš„ä»£ä»·å—ã€‚



```
Â·Â·******
*Â·Â·Â·*Â·Â·*
***Â·*Â·**
**Â·Â·*Â·**
*Â·Â·*#Â·Â·*
**Â·***Â·*
**Â·Â·Â·Â·Â·*
********
```

é‚£ä¹ˆ[**'0'**,**'o'**,**'O'**,**'.'**]ä¹Ÿå°±æ˜¯å››ä¸ªæ–¹å‘ï¼Œèµ°å‡ºè¿·å®«çš„è·¯å¾„å°±æ˜¯flagï¼Œå¼€å§‹åœ¨åˆ†æžv9çš„æ—¶å€™ï¼ˆidaä¸€å¼€å§‹æ˜¾ç¤ºæˆv10ï¼Œç±»åž‹æ˜¯__int64ï¼‰ï¼Œæ€»æ˜¯ä¸çŸ¥é“åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆï¼ŒSHIDWORDä¹‹å‰ä¹Ÿæ²¡è§è¿‡ï¼ŒæŽ¨æµ‹æ˜¯ä¸æ˜¯è®¡æ•°å™¨ï¼Œä½†æ˜¯çŸ¥é“æ˜¯è¿·å®«ä¹‹åŽï¼ŒçŒœæµ‹å¯èƒ½æ˜¯äºŒç»´æ•°ç»„ã€‚

æŸ¥èµ„æ–™ä¹‹åŽå‘çŽ°è¿™ä¸ª[issue](https://reverseengineering.stackexchange.com/questions/8296/whats-the-function-of-lodword-and-hidword)é‡Œé¢æœ‰è¯¦ç»†è§£é‡Šï¼ŒSHIDWORDå…¶å®žå°±æ˜¯å–v9çš„é«˜ä½ï¼Œå­˜å‚¨çš„æ˜¯åˆ—ï¼Œv9ä½Žä½æ˜¯è¡Œï¼Œè¿™ä¸ªä»Žæœ€åŽä¸€å¥åˆ¤æ–­æ˜¯ä¸æ˜¯æ‰¾åˆ°å‡ºå£äº†å¯ä»¥çœ‹å‡ºæ¥ã€‚

```
 if ( asc_601060[8 * (signed int)v9 + SHIDWORD(v9)] != 35 )
```

é‚£ä¹ˆå†çœ‹å’Œå››ä¸ªæ–¹å‘ç›¸å…³çš„å‡½æ•°ï¼ŒåŠ æ³•çš„å°±æ˜¯ðŸ‘‡ï¼ŒðŸ‘‰ï¼Œå‡æ³•çš„å°±æ˜¯ðŸ‘‡ï¼ŒðŸ‘ˆï¼›å†çœ‹å…·ä½“ä¼ å…¥å‡½æ•°çš„å‚æ•°ï¼Œ`(_DWORD *)&v9 + 1`å’Œ`(int *)&v9`ï¼Œä¼ å…¥çš„æ˜¯åœ°å€ï¼Œ+1ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ï¼Œå› ä¸ºå°ç«¯å­˜å‚¨ï¼Œé«˜ä½æ”¾åœ¨é«˜åœ°å€é‡Œé¢ï¼Œé‚£ä¹ˆæ˜¾ç„¶`&v9 + 1`å°±æ˜¯`SHIDWORD(v9)`ã€‚åŠ ä¸Šè‡ªå‡æ“ä½œï¼Œæ‰€ä»¥Oå¯¹åº”çš„å°±æ˜¯å·¦ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚

```
O  o  . 0
å·¦ å³ ä¸Š ä¸‹  
```

ä¸ªäººè§‰å¾—è¿™é“é¢˜ä¸€å¦‚ä»¥ä¸Šæ¥å°±èŽ½çš„è¯è›®æžå¿ƒæ€çš„ï¼Œä½†æ˜¯å¦‚æžœç»“åˆé¢˜ç›®å’Œæè¿°å„æ–¹é¢ä¿¡æ¯+ç»éªŒå¤šå¯¹è¿™äº›æ•æ„Ÿçš„è¯å°±å…¶å®žç®€å•ã€‚æ–­æ–­ç»­ç»­åšäº†å¥½å‡ å¤©ï¼Œå·®ç‚¹å°±åšä¸ä¸‹åŽ»äº†ã€‚ä¸è¿‡ä¹Ÿå‘çŽ°è‡ªå·±æŒ‡é’ˆä»€ä¹ˆçš„å…¨éƒ¨å¿˜å…‰äº†ï¼Œåªæ˜¯è¿˜æ˜¯è¦ç»å¸¸ç”¨æ‰è®°å¾—ä½ã€‚

#### csaw2013reversing2

æœ€åŽä¸€é¢˜ï¼Œç›®æ ‡å°±æ˜¯åƒåˆé¥­ä¹‹å‰åšå®Œï¼Œå†å¤šæ—¶é—´å°±ä¸åšäº†ï¼Œè¿è¡Œå‘çŽ°è¾“å‡ºä¹±ç ï¼Œé¢˜ç›®æè¿°ä¹Ÿæ˜¯â€œå¬è¯´è¿è¡Œå°±èƒ½æ‹¿åˆ°Flagï¼Œä¸è¿‡èœé¸¡è¿è¡Œçš„ç»“æžœä¸çŸ¥é“ä¸ºä»€ä¹ˆæ˜¯ä¹±ç â€ã€‚

å…ˆç”¨idaç®€å•çœ‹ä¸€ä¸‹æ•´ä¸ªç¨‹åºã€‚IsDebuggerPresent() ç¬¬ä¸€ç›´è§‰å°±æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯åè°ƒè¯•çš„ç›¸å…³çš„ï¼ŒåŽé¢æŸ¥äº†ä¸€ä¸‹ï¼Œçš„ç¡®æ˜¯ã€‚é‚£å°±åˆ†æžä¸€ä¸‹ä¹±ç çš„å¯èƒ½åŽŸå› ã€‚æŽ¨æµ‹sub_401000()å‡½æ•°å°±æ˜¯ä¸€ä¸ªè¿˜åŽŸflagçš„å‡½æ•°ï¼Œä½†æ˜¯å› ä¸ºç›´æŽ¥é€€å‡ºäº†ï¼Œæ‰€ä»¥æ²¡åŠžæ³•è¾“å‡ºflagã€‚

æˆ‘æœ€å¼€å§‹çš„æƒ³æ³•å°±æ˜¯é€šè¿‡OllydbgåŠ¨æ€è°ƒè¯•ï¼Œç„¶åŽåœ¨ä»–ExitProcessä¹‹å‰èŽ·å–flagï¼Ÿä¸»è¦åœ¨IsDebuggerPresent()å’ŒExitProcess()ä¸‹äº†æ–­ç‚¹ï¼Œä½†æ˜¯åŠå¤©æ‰¾ä¸åˆ°å­—ç¬¦ä¸²å­˜å‚¨çš„ä½ç½®ï¼ŒçœŸçš„æµæ³ªäº†ï¼ŒOllydbgæˆ‘çœŸçš„å¾ˆä¸ç†Ÿç»ƒï¼Œè¿˜æ˜¯å‡†å¤‡çœ‹æºç ã€‚

é‡ç‚¹å…³æ³¨sub_401000()å‡½æ•°ã€‚

```
unsigned int __fastcall sub_401000(int a1, int a2)
{
  int v2; // esi
  unsigned int v3; // eax
  unsigned int v4; // ecx
  unsigned int result; // eax

  v2 = dword_409B38;
  v3 = a2 + 1 + strlen((const char *)(a2 + 1)) + 1;
  v4 = 0;
  result = ((v3 - (a2 + 2)) >> 2) + 1;
  if ( result )
  {
    do
      *(_DWORD *)(a2 + 4 * v4++) ^= v2;
    while ( v4 < result );
  }
```



å› ä¸ºæˆ‘ä¸æƒ³èŠ±å¤ªå¤šæ—¶é—´åœ¨è¿™é“é¢˜ä¸Šé¢äº†ï¼Œæˆ‘ä¸ªäººè§‰å¾—èŠ±å¤ªå¤šæ—¶é—´åšç®€å•é¢˜ï¼ŒæŽ‰åˆ°ä¸€äº›å‘é‡Œé¢ï¼Œæ¶ˆç£¨æ–—å¿—ï¼ŒçœŸçš„å¾—ä¸å¿å¤±ï¼ˆæ¥è‡ªmazeçš„è¡€çš„æ•™è®­ï¼‰ã€‚é‡ç‚¹å…³æ³¨å¾ªçŽ¯ï¼Œå¾ªçŽ¯é‡Œé¢åšçš„å°±æ˜¯ä¸€æ¬¡å–å››ä¸ªï¼ˆå› ä¸ºæ˜¯DWORDï¼‰ç„¶åŽä¾æ¬¡å¼‚æˆ–ã€‚

resultæ˜¯å¾ªçŽ¯æ¬¡æ•°ï¼ŒæŒ‰ç†æ¥è¯´åº”è¯¥å…ˆåˆ†æžv3ï¼Œä½†æ˜¯a2åˆæ˜¯intåž‹ï¼Œåˆæ˜¯const char *æœ‰ç‚¹è¿·æƒ‘äº†ï¼Œç›´æŽ¥çœ‹ï¼Œç®€åŒ–æˆ`strlen((const char *)(a2 + 1)/4 +1`ï¼Œè¿™é‡Œå¤§èƒ†å‡è®¾åº”è¯¥å°±æ˜¯9æ¬¡ï¼Œä¸€è½®ï¼Œæ‰€æœ‰çš„å­—ç¬¦éƒ½å¼‚æˆ–ä¸€æ¬¡ã€‚

è§£å¯†çš„ç®—æ³•æ¯”è¾ƒç®€å•ï¼Œç›´æŽ¥ä¾æ¬¡å’Œ`0DDCCAABBh`æŠ‘æˆ–å°±å®Œäº‹äº†ï¼Œä½†æ˜¯å‘çŽ°ç»“æžœå±…ç„¶ä¸å¤ªå¯¹ï¼Œæˆ‘æƒ³è¯¥ä¸ä¼šæ˜¯resultæ¬¡æ•°ä¸å¯¹å§ï¼Œä½†æ˜¯åŽæ¥å‘çŽ°ï¼Œåˆæ˜¯å°æ®µå­˜å‚¨çš„é—®é¢˜ï¼Œ`0DDCCAABBh`å¼‚æˆ–çš„æ—¶å€™åº”è¯¥æ˜¯`arr = [0xBB,0xAA,0xCC,0xDD]`ï¼Œç„¶åŽå¾—åˆ°flagã€‚

åŽæ¥æƒ³çœ‹çœ‹è¿™é“é¢˜åŠ¨æ€è°ƒè¯•çš„è§£æ³•ï¼Œç»“æžœçœ‹åˆ°ä¸€ä¸ªåŒ…å«[3ç§è§£æ³•çš„wp](https://blog.csdn.net/weixin_43784056/article/details/103655968)ï¼Œè¿™å°±æ˜¯æˆ‘å’Œåˆ«äººçš„å·®è·å—ã€‚å‡†å¤‡å†™å®Œéƒ½è¯•ä¸€è¯•ï¼ŒçœŸçš„ä¸é”™ã€‚



### å°ç»“

è¿™æ®µæ—¶é—´ï¼Œä¹Ÿç®—æ˜¯ç£•ç£•ç»Šç»Šã€æ–­æ–­ç»­ç»­æŠŠxctfçš„æ–°æ‰‹é€†å‘é¢˜åšå®Œäº†ï¼Œæˆ‘çœŸçš„å±žäºŽå¯¹é€†å‘ä¸€çªä¸é€šçš„äº†ã€‚ä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯æœ‰ä¸€äº›å°æŠ€å·§ã€‚

1. å…¨å±€æœç´¢å­—ç¬¦ä¸²ï¼Œæ„Ÿè§‰æœ€ç®€å•çš„ç­¾åˆ°é¢˜åº”è¯¥å°±æ˜¯è¿™ä¸ªæ°´å¹³

2. é™æ€åˆ†æžIDA F5åæ±‡ç¼–ï¼Œè¯»Cä»£ç çš„èƒ½åŠ›

3. å¤šå…³æ³¨å­—ç¬¦ä¸²æ¯”è¾ƒçš„åœ°æ–¹ï¼Œåå­—ç±»ä¼¼decryptçš„å°±å¾ˆæœ‰å¯èƒ½æ˜¯å¯¹flagè¿›è¡Œç®€å•çš„åŠ è§£å¯†

4. pythonè¦ç†Ÿç»ƒä½¿ç”¨ord()å’Œchr()

5. 16è¿›åˆ¶ä¸ŽASCIIç ï¼Œå¯ä»¥æ•æ„Ÿä¸€ç‚¹

6. çŸ¥é“å°ç«¯å­˜å‚¨

7. åŠ¨æ€è°ƒè¯•å¤šæ³¨æ„jmpã€callä¹‹ç±»çš„è·³è½¬æŒ‡ä»¤

8. è„±å£³ç›®å‰åªåšäº†ä¸€ä¸ªå¾ˆç®€å•çš„ç›¸å…³çš„ï¼Œä¸€èˆ¬å¥½åƒç¬¬ä¸€æ­¥å°±æ˜¯å…ˆçœ‹ç¨‹åºæœ‰æ²¡æœ‰å£³ï¼Œæˆ‘çŽ°åœ¨çš„çŸ¥è¯†ä¹Ÿä»…ä»…æ­¢æ­¥äºŽupx -d

9. idaçš„pythonç»ˆç«¯åšé¢˜çš„æ—¶å€™è¿˜æ˜¯éžå¸¸æœ‰ç”¨çš„ï¼Œç›®å‰ç”¨çš„è¿˜åœç•™åœ¨dumpä¸€äº›æ¯”è¾ƒå…³é”®çš„æ•°æ®ï¼Œä¸‹é¢è¿™ä¸ªåœ¨csaw2013reversing2é¢˜ç›®é‡Œé¢ç”¨åˆ°è¿‡çš„ï¼Œåº”è¯¥æ²¡å¤ªå¤§é—®é¢˜ï¼Œæœ‰æ—¶å€™å¯èƒ½éœ€è¦æçš„æ•°æ®ç±»åž‹ä¸å¤ªä¸€æ ·

   ```
   adrr = 0x409B10
   arr =[]
   for i in range(36):
       arr.append(idc.Byte(adrr+i))
   print(arr)
   ```

10. è™½ç„¶å‹‰å‹‰å¼ºå¼ºçš„åšå®Œäº†XCTFé‡Œé¢é€†å‘çš„ç®€å•é¢˜ï¼Œä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯å·®å¾ˆè¿œï¼Œä¸€ä¸ªæ˜¯æœ‰æ—¶å€™åšé¢˜é€Ÿåº¦å¤ªæ…¢äº†ï¼ŒäºŒæ˜¯ç›¸å…³è½¯ä»¶ä½¿ç”¨éžå¸¸ä¸ç†Ÿç»ƒï¼Œä¸‰æ˜¯åŠ¨æ€è°ƒè¯•èƒ½åŠ›åŸºæœ¬æ²¡æœ‰ï¼Œè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œç»§ç»­åŠ æ²¹ã€‚

